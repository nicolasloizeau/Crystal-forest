{"version":3,"file":"math-CJgeBN_r.js","names":["n: number","str: string","p: number","c: string","start: number","decoder: (s: string) => number","hash: string"],"sources":["../src/math.ts"],"sourcesContent":["import { isEthereumAddressValid, isTezosAddressValid } from \"./address\"\nimport { BASE58_CHARSET } from \"./constants\"\nimport { isEthereumTransactionHashValid } from \"./hash\"\nimport { ResettableRandFunction } from \"./types/math\"\n\nexport function getRandomHash(n: number): string {\n  return Array(n)\n    .fill(0)\n    .map(function (_) {\n      return BASE58_CHARSET[(Math.random() * BASE58_CHARSET.length) | 0]\n    })\n    .join(\"\")\n}\n\nfunction b58dec(str: string): number {\n  return [...str].reduce(function (p: number, c: string): number {\n    return (p * BASE58_CHARSET.length + BASE58_CHARSET.indexOf(c)) | 0\n  }, 0)\n}\n\nfunction sfc32([a, b, c, d]: number[]): () => number {\n  return function () {\n    a |= 0\n    b |= 0\n    c |= 0\n    d |= 0\n    const t = (((a + b) | 0) + d) | 0\n    d = (d + 1) | 0\n    a = b ^ (b >>> 9)\n    b = (c + (c << 3)) | 0\n    c = (c << 21) | (c >>> 11)\n    c = (c + t) | 0\n    return (t >>> 0) / 4294967296\n  }\n}\n\nfunction matcher(\n  str: string,\n  start: number,\n  decoder: (s: string) => number = b58dec\n): number[] {\n  const matches = str\n    .slice(start)\n    .match(new RegExp(\".{\" + ((str.length - start) >> 2) + \"}\", \"g\"))\n  return matches ? matches.map(decoder) : []\n}\n\nfunction getSeedFromHash(hash: string): number[] {\n  // Accounting for ethereum and base\n  if (isEthereumTransactionHashValid(hash) || isEthereumAddressValid(hash)) {\n    return matcher(hash, 2, s => Number(BigInt(`0x${s}`) % BigInt(0xffffffff)))\n  } else if (isTezosAddressValid(hash)) {\n    return matcher(hash, 3)\n  } else {\n    return matcher(hash, 2)\n  }\n}\n\nexport function createFxRandom(hash: string): ResettableRandFunction {\n  const seed = getSeedFromHash(hash)\n  return sfc32(seed)\n}\n"],"mappings":";;;;;AAKA,SAAgB,cAAcA,GAAmB;AAC/C,QAAO,MAAM,EAAE,CACZ,KAAK,EAAE,CACP,IAAI,SAAU,GAAG;AAChB,SAAO,eAAgB,KAAK,QAAQ,GAAG,eAAe,SAAU;CACjE,EAAC,CACD,KAAK,GAAG;AACZ;AAED,SAAS,OAAOC,KAAqB;AACnC,QAAO,CAAC,GAAG,GAAI,EAAC,OAAO,SAAUC,GAAWC,GAAmB;AAC7D,SAAQ,IAAI,eAAe,SAAS,eAAe,QAAQ,EAAE,GAAI;CAClE,GAAE,EAAE;AACN;AAED,SAAS,MAAM,CAAC,GAAG,GAAG,GAAG,EAAY,EAAgB;AACnD,QAAO,WAAY;AACjB,OAAK;AACL,OAAK;AACL,OAAK;AACL,OAAK;EACL,MAAM,KAAO,IAAI,IAAK,KAAK,IAAK;AAChC,MAAK,IAAI,IAAK;AACd,MAAI,IAAK,MAAM;AACf,MAAK,KAAK,KAAK,KAAM;AACrB,MAAK,KAAK,KAAO,MAAM;AACvB,MAAK,IAAI,IAAK;AACd,UAAQ,MAAM,KAAK;CACpB;AACF;AAED,SAAS,QACPF,KACAG,OACAC,UAAiC,QACvB;CACV,MAAM,UAAU,IACb,MAAM,MAAM,CACZ,MAAM,IAAI,OAAO,QAAS,IAAI,SAAS,SAAU,KAAK,KAAK,KAAK;AACnE,QAAO,UAAU,QAAQ,IAAI,QAAQ,GAAG,CAAE;AAC3C;AAED,SAAS,gBAAgBC,MAAwB;AAE/C,KAAI,+BAA+B,KAAK,IAAI,uBAAuB,KAAK,CACtE,QAAO,QAAQ,MAAM,GAAG,OAAK,OAAO,QAAQ,IAAI,EAAE,EAAE,GAAG,OAAO,WAAW,CAAC,CAAC;UAClE,oBAAoB,KAAK,CAClC,QAAO,QAAQ,MAAM,EAAE;KAEvB,QAAO,QAAQ,MAAM,EAAE;AAE1B;AAED,SAAgB,eAAeA,MAAsC;CACnE,MAAM,OAAO,gBAAgB,KAAK;AAClC,QAAO,MAAM,KAAK;AACnB"}